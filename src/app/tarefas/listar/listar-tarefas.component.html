<a mat-fab
  color="accent"
  matTooltip="Adicionar Nova Tarefa"
  routerLink="/tarefas/inserir"
  class="btn-adicionar">
  <mat-icon>add</mat-icon>
</a>

<div class="row align-content-start justify-content-center h-100">
  <app-titulo-pagina icone="task">Visualização de Tarefas</app-titulo-pagina>
  <ng-container *ngIf="true && (tarefas$ | async) as tarefasCadastradas">
    <app-descricao-pagina>
      Atualmente você tem {{ tarefasCadastradas.length }} {{tarefasCadastradas.length > 1 ? 'tarefas cadastradas' : 'tarefa cadastrada' }} no sistema.
    </app-descricao-pagina>

  </ng-container>

  <section #tabelaTarefas *ngIf="(tarefas$ | async)?.length; else tarefasNaoEncontradas">
    <table class="w-100" mat-table [dataSource]="tarefas$" >
      <ng-container matColumnDef="Título">
        <th class="text-center fs-6 fw-bold" mat-header-cell *matHeaderCellDef>Título</th>
        <td class="text-center fs-6" mat-cell *matCellDef="let tarefa"> {{tarefa.titulo}} </td>
      </ng-container>
      <ng-container matColumnDef="Prioridade">
        <th class="text-center fs-6 fw-bold" mat-header-cell *matHeaderCellDef>Prioridade</th>
        <td class="text-center fs-6" mat-cell *matCellDef="let tarefa"> {{tarefa.prioridade}} </td>
      </ng-container>

      <ng-container matColumnDef="Ações">
        <th class="text-center fs-6 fw-bold" mat-header-cell *matHeaderCellDef>Ações</th>
        <td mat-cell *matCellDef="let tarefa">
          <div class="row justify-content-center gap-2">
            <ng-container
              [ngSwitch]="(isHandset$ | async)">
              <ng-container
                *ngSwitchCase="true"
                [ngTemplateOutlet]="botoesMobile"
                [ngTemplateOutletContext]="{ id: tarefa.id }"></ng-container>
              <ng-container
                *ngSwitchCase="false"
                [ngTemplateOutlet]="botoesPadrao"
                [ngTemplateOutletContext]="{ id: tarefa.id }"></ng-container>
            </ng-container>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="colunasExibidas"></tr>
      <tr mat-row *matRowDef="let row; columns: colunasExibidas;"></tr>
    </table>

  </section>
</div>

<ng-template #tarefasNaoEncontradas>
  <div class="row h-50 text-center">
    <mat-card class="d-flex justify-content-center align-items-center">
      <p class="fs-3">Nenhum registro disponível.</p>
    </mat-card>
  </div>
</ng-template>

<ng-template #botoesPadrao let-id="id">
  <a mat-mini-fab
    color="accent"
    role="button"
    [routerLink]="['/tarefas/editar', id]"
    matTooltip="Editar Tarefa"
    aria-label="Editar tarefa">
    <mat-icon>edit</mat-icon>
  </a>
  <a mat-mini-fab
    color="warn"
    role="button"
    [routerLink]="['/tarefas/excluir', id]"
    matTooltip="Excluir Tarefa"
    aria-label="Excluir tarefa">
    <mat-icon>delete</mat-icon>
    <!-- Excluir -->
  </a>
</ng-template>

<ng-template #botoesMobile let-id="id">
  <a mat-mini-fab
    color="accent"
    class="col-1"
    role="button"
    [routerLink]="['/tarefas/editar', id]"
    aria-label="Editar tarefa">
    <mat-icon>edit</mat-icon>
  </a>
  <a mat-mini-fab
    color="warn"
    class="col-1"
    role="button"
    [routerLink]="['/tarefas/excluir', id]"
    aria-label="Excluir tarefa">
    <mat-icon>delete</mat-icon>
  </a>
</ng-template>
